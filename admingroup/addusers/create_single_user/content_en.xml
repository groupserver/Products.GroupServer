<?xml version="1.0" ?>
<root xmlns:tal="http://xml.zope.org/namespaces/tal" 
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:xf="http://www.w3.org/2002/xforms">
  <data
    tal:content="structure python:here.models(method='xml')"/>
  <output>
    <content 
      tal:define="group_object here/Scripts/get/group_object;
      joinable python:here.LocalScripts.get.usersCanJoinGroup(group_object.getId(),True);
      canJoin python:joinable[0];">
      
      <heading1>Create a New Group Member</heading1>
      
      <tal:block tal:condition="canJoin">
        
        <paragraph>
          You can create a new member by filling out the following fields
          and clicking Create Member below.
          The email address and preferred name of the new member are required.
        </paragraph>
        
        <paragraph>Once the member has been created, he or she will be
          sent a message asking them to verify.
          Unless the member verifies, he or she cannot participate in the
          online group.</paragraph>
        
        <xf:input model="createuser" bind="email" class="text">
          <xf:label>Email</xf:label>
          <xf:hint>Please enter the member's email address (required)</xf:hint>
        </xf:input>
               
        <xf:input model="createuser" bind="preferredname" class="text">
          <xf:label>Preferred Name</xf:label>
          <xf:hint>Please enter the member's preferred name (required)</xf:hint>
        </xf:input>
        
        <tal:block
          tal:condition="python:(user in here.Scripts.get.users_from_groups(['trusted_site_administrators'])) or ('Manager' in user.getRolesInContext(here.Scripts.get.group_object()))">
          <xf:select appearance="full" model="createuser" 
            ref="sendVerification" class="singlecheck">
            <xf:label>Require member to verify?</xf:label>
            <xf:hint></xf:hint>
            <xf:item>
              <xf:label></xf:label>
            <xf:value>1</xf:value>
            </xf:item>
          </xf:select>
        </tal:block>
        <xf:submit model="createuser" submission="create" class="button">
          <xf:label>Create Member</xf:label>
        <xf:hint>Create the new member</xf:hint>
        </xf:submit>
      </tal:block>
      <tal:block tal:condition="python:not canJoin">
        <paragraph>
          Normally, you could create a new member of
          <span class="group" tal:content="group_object/title_or_id"/>,
          but <span tal:content="python:joinable[1][1].lower()"/>.
        </paragraph>
      </tal:block>
    </content>
  </output>
</root>
