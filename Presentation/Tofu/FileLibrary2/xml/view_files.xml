<root xmlns:tal="http://xml.zope.org/namespaces/tal" xmlns:metal="http://xml.zope.org/namespaces/metal" metal:use-macro="here/Templates/page.xml/macros/page">
  <output xmlns:xf="http://www.w3.org/2002/xforms">
	  <data metal:fill-slot="data">
	    <xf:model id="find_file">
	      <xf:instance>
	        <data>
	          <submitted>1</submitted>
	          <s_order>asc</s_order>
	          <modification_time tal:content="request/form/modification_time | string:0"/>
	          <b_size tal:content="request/form/b_size | string:10"/>
	          <topic tal:content="request/form/topic | string:"/>
	          <tags tal:content="request/form/tags | string:"/>
	        </data>
	      </xf:instance>
	      <xf:submission id="findFiles" method="get"
	        tal:attributes="action request/URL" />
	    </xf:model>
	  </data>

    <messages metal:fill-slot="messages">
    	<message type="result" tal:condition="python:request.form.get('message', None) == 'hide'">
    	   The file has been tagged as 'hidden', and will no longer be shown in the normal file list. You
    	   may display all hidden files by selecting the tag 'hidden'.
    	</message>
    </messages>
    
    <content metal:fill-slot="maincontent">
      <h1>Files</h1>

      <p><a href="view_add_file">Add File</a></p>
      
      <xf:select1 appearance="minimal"
          model="find_file" ref="b_size"
          class="text">
          <xf:label>Items to Show</xf:label>
          <xf:hint>
            How many matching items would you like to show at once?
          </xf:hint>
        <xf:item>
          <xf:label>5</xf:label>
          <xf:value>5</xf:value>
        </xf:item><xf:item>
          <xf:label>10</xf:label>
          <xf:value>10</xf:value>
        </xf:item><xf:item>
          <xf:label>25</xf:label>
          <xf:value>25</xf:value>
        </xf:item><xf:item>
          <xf:label>50</xf:label>
          <xf:value>50</xf:value>
        </xf:item>
      </xf:select1>
      
      <xf:select1 appearance="minimal"
        model="find_file" ref="modification_time"
        class="text">
        <xf:label>Age of File</xf:label>
        <xf:hint>
          How recently was the file you are looking for published?
        </xf:hint>
        <xf:item>
          <xf:label>Very recent</xf:label>
          <xf:value>recent</xf:value>
        </xf:item>
        <xf:item>
          <xf:label>Today</xf:label>
          <xf:value>today</xf:value>
        </xf:item>
        <xf:item>
          <xf:label>Yesterday</xf:label>
          <xf:value>yesterday</xf:value> 
        </xf:item>
        <xf:item>
          <xf:label>Past week</xf:label>
          <xf:value>week</xf:value> 
        </xf:item>
        <xf:item>
          <xf:label>Past month</xf:label>
          <xf:value>month</xf:value> 
        </xf:item>
        <xf:item>
          <xf:label>Past year</xf:label>
          <xf:value>year</xf:value> 
        </xf:item>
        <xf:item>
          <xf:label>Not sure (show any age)</xf:label>
          <xf:value>0</xf:value>
        </xf:item>
      </xf:select1>
      
      <xf:select1 appearance="minimal"
        model="find_file" ref="topic"
        class="text">
        <xf:label>Topic</xf:label>
        <xf:hint>
          Are you looking for files related to a specific topic?
        </xf:hint>
        <xf:item>
          <xf:label>No specific topic</xf:label>
          <xf:value></xf:value>
        </xf:item>
        <xf:item tal:repeat="topic options/topics">
          <xf:label tal:content="topic">sometopic</xf:label>
          <xf:value tal:content="topic">sometopic</xf:value>
        </xf:item>
      </xf:select1>

      <xf:select1 appearance="minimal"
        model="find_file" ref="tags"
        class="text">
        <xf:label>Tags</xf:label>
        <xf:hint>
          Are you looking for files related to a specific tag?
        </xf:hint>
        <xf:item>
          <xf:label>No specific tag</xf:label>
          <xf:value></xf:value>
        </xf:item>
        <xf:item tal:repeat="tag options/tags">
          <xf:label tal:content="tag">sometopic</xf:label>
          <xf:value tal:content="tag">sometopic</xf:value>
        </xf:item>
      </xf:select1>
      
      <xf:submit class="button" model="find_file" submission="findFiles">
        <xf:label>Search</xf:label>
      </xf:submit>
            
      <adl:slot xmlns:adl="http://iopen.net/ns/adl" name="listfiles"
                tal:attributes="b_size request/form/b_size | string:10">
                 <span class="network-waiting">Finding matches...</span>
        <files:selector xmlns:files="http://iopen.net/ns/files"
                        tal:attributes="batchsize request/form/b_size | string:10;
                                        batchstart request/form/b_start | string:1;
                                        modificationtime request/form/modification_time | string:0;
                                        topic request/form/topic | string:;
                                        tags request/form/tags | string:"
                                         
                        slotname="listfiles"/>
      </adl:slot>
    </content>
</output>
</root>
