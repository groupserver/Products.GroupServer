<?xml version="1.0" encoding="UTF-8"?>
<root xmlns:tal="http://xml.zope.org/namespaces/tal" 
	xmlns:metal="http://xml.zope.org/namespaces/metal" 
	metal:use-macro="here/Templates/page.xml/macros/page">
  <output xmlns:xf="http://www.w3.org/2002/xforms">

    <messages metal:fill-slot="messages" 
      tal:define="message python:options.get('result',{}).get('message', '')"
      tal:condition="message">
      <message type="result" tal:content="structure message">
      </message>
    </messages>
    
    <data metal:fill-slot="data">
      <xf:model id="file">
        <xf:instance>
          <data>
            <submitted>1</submitted>
            <file />
            <topic />
            <tags />
            <summary />
						<sendEmailNotification>1</sendEmailNotification>
          </data>
        </xf:instance>
        <xf:submission method="form-data-post" id="addFile"
          tal:attributes="action request/URL" />
      </xf:model>
    </data>
    
    <content metal:fill-slot="maincontent">
      <p><a href="view_files">View Existing Files</a></p>
      <fieldset>
        <legend>Add a new file</legend>
        <xf:upload class="text" model="file" ref="file" submission="addFile">
          <xf:label>File</xf:label>
        </xf:upload>
        
        <xf:select1 appearance="minimal"
          model="file" ref="topic"
          class="text">
          <xf:label>Associate with topic</xf:label>
          <xf:hint>
            You may associate this file with an existing topic.
          </xf:hint>
          <xf:item>
            <xf:label>No topic</xf:label>
            <xf:value></xf:value>
          </xf:item>
          <xf:item tal:repeat="topic options/topics">
            <xf:label tal:content="topic">sometopic</xf:label>
            <xf:value tal:content="topic">sometopic</xf:value>
          </xf:item>
        </xf:select1>

        <p><strong>or</strong></p>

        <xf:input model="file" ref="topic" class="text">
          <xf:label>Create new topic</xf:label>
          <xf:hint>
            Alternatively, you may create a new topic for this file
          </xf:hint>
        </xf:input>

        <xf:input model="file" ref="summary" class="text">
          <xf:label>Summary</xf:label>
          <xf:hint>
            You should provide a summary of the file, to help people
            understand the file
          </xf:hint>
        </xf:input>
        
        <xf:textarea class="text" model="file" ref="tags">
          <xf:label>Tags</xf:label>
          <xf:hint>
            You may add arbitrary tags to this file, one per line. This
            will help people find your file
          </xf:hint>
        </xf:textarea>

				<xf:select appearance="full" model="file" 
					ref="sendEmailNotification" class="singlecheck">
         <xf:label>Send Email Notification</xf:label>
         <xf:hint>Send all group members an email notification of the
						addition</xf:hint>
					<xf:item>
						<xf:label></xf:label>
						<xf:value>1</xf:value>
					</xf:item>
				</xf:select>
				
        <xf:submit class="button" model="file" submission="addFile">
          <xf:label>Add File</xf:label>
        </xf:submit>
      </fieldset>
    </content>
    
  </output>
</root>
