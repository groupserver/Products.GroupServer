<?xml version="1.0" encoding="UTF-8" ?>
<root xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  metal:use-macro="here/Templates/page.xml/macros/page">
  <output>
    <content metal:fill-slot="maincontent" tal:define="xcu
      python:modules['Products.XWFCore.XWFUtils']; rfr python:xcu.createRequestFromRequest;
      munge_date python:modules['Products.XWFCore.XWFUtils'].munge_date;
      durl python:here.Scripts.get.division_url()">
      <div class="batchcount" tal:condition="options/result_size"><span tal:replace="options/b_start"/> to <span tal:replace="options/b_end"/> of <span tal:replace="options/result_size"/></div>
      <div class="batchnavigation">
        <a tal:condition="python:options['b_start']-1 > 0" tal:attributes="href python:'%s/view_files?%s' % (request.URL1, rfr(request, b_start=options['b_start']-options['b_size']))">prev <span tal:replace="python:options['b_size']"/></a>
        &#160;&#160;&#160; 
        <a tal:condition="python:options['result_size'] &gt; options['b_end']" tal:attributes="href python:'%s/view_files?%s' % (request.URL1, rfr(request, b_start=options['b_end']+1))">next <span tal:replace="python:min(options['result_size']-options['b_end'], options['b_size'])"/></a>
      </div>
      <div tal:condition="not:options/result_set">No matching files found</div>
      <ul class="files" tal:condition="options/result_set">
        <li class="searchitem" tal:repeat="result options/result_set">
          <a tal:attributes="href python:'f/%s/%s' % (result.id, result.title)">
            <span class="searchlink" tal:content="result/title">link</span>
          </a>
	  (<span class="searchsize"
	     tal:content="python:here.pretty_size(result.size)">
		-1GB</span>,
             <span class="searchcontenttype">
		<tal:block tal:content="python:result.content_type" />
	  </span>)
	  uploaded by
	  <a tal:condition="python:getattr(result, 'dc_creator', None)" 
	    class="searchuser"
	    tal:attributes="href python:'%s/contacts/%s' % (durl, result.dc_creator)" 
	    tal:define="user python:here.Scripts.get.user_realnames(result.dc_creator)" 
	    tal:content="python:user">Username</a>
	  on
          <span class="searchtime"
	    tal:content="python:munge_date(here, result['modification_time'])">
		1977-01-01
	  </span> <span tal:condition="python:user.getId()"><a tal:condition="python:'hidden' not in result['tags']" class="taghidden" tal:attributes="href python:'hide_file?id=%s' % result.id">hide file</a>
	          <a tal:condition="python:'hidden' in result['tags']" class="tagshow" tal:attributes="href python:'show_file?id=%s' % result.id">show file</a></span>
	  <div class="description">
            <div class="searchdescription" 
	      tal:content="python:here.printable_summary(result) or 'No summary available'">
	      This is a description of the file, pulled from the stuff in the 
	      file.
	    </div>
	  </div><!--description-->
	  <div class="searchinfo">
	    <div class="infotopic"
              tal:condition="result/topic">
	      Topic:
	      <span class="searchtopic" tal:content="result/topic">
		This is the topic of the file.
	      </span>
	    </div><!--infotopic-->
	    <div class="infotags"
              tal:condition="result/tags">
	      Tags: 
	      <tal:block tal:repeat="tag result/tags">
		<q class="searchtags"
                tal:content="tag"/>
	      </tal:block>
	    </div><!--infotags-->
	  </div><!--searchinfo-->
	</li>
      </ul>
      <div class="batchcount" tal:condition="options/result_size"><span tal:replace="options/b_start"/> to <span tal:replace="options/b_end"/> of <span tal:replace="options/result_size"/></div>
      <div class="batchnavigation">
        <a tal:condition="python:options['b_start']-1 > 0" tal:attributes="href python:'%s/view_files?%s' % (request.URL1, rfr(request, b_start=options['b_start']-options['b_size']))">prev <span tal:replace="python:options['b_size']"/></a>
        &#160;&#160;&#160; 
        <a tal:condition="python:options['result_size'] &gt; options['b_end']" tal:attributes="href python:'%s/view_files?%s' % (request.URL1, rfr(request, b_start=options['b_end']+1))">next <span tal:replace="python:min(options['result_size']-options['b_end'], options['b_size'])"/></a>
      </div>
    </content>
  </output>
</root>
